<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>完全示例 | </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.1.0">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="../traslation-of-xlib/README.html" />
    
    
    <link rel="prev" href="../messing-with-the-mouse-cursor/setting-a-windows-mouse-cursor.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book" data-level="14.3" data-basepath=".." data-revision="1415502450786">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="basic-xcb-notion/README.html">
            
                
                    <a href="../basic-xcb-notion/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         基本的 XCB 概念
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1" data-path="basic-xcb-notion/the-x-connection.html">
            
                
                    <a href="../basic-xcb-notion/the-x-connection.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         X 連接
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="basic-xcb-notion/the-xlib-killers.html">
            
                
                    <a href="../basic-xcb-notion/the-xlib-killers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         請求與回覆：殺掉 Xlib 效率的殺手
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3" data-path="basic-xcb-notion/the-graphics-context.html">
            
                
                    <a href="../basic-xcb-notion/the-graphics-context.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                         圖形上下文
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.4" data-path="basic-xcb-notion/event.html">
            
                
                    <a href="../basic-xcb-notion/event.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                         事件
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="using-xcb-based-programs/README.html">
            
                
                    <a href="../using-xcb-based-programs/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         上基於 XCB 的程序
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="connection-to-an-X-server/README.html">
            
                
                    <a href="../connection-to-an-X-server/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         建立和關閉到 X 服務器的連接
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="checking-info-about-a-connection/README.html">
            
                
                    <a href="../checking-info-about-a-connection/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         檢查連接的基本信息
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5" data-path="hello-world/README.html">
            
                
                    <a href="../hello-world/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         創建一個窗口——泥嚎，世界
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6" data-path="drawing-in-a-window/README.html">
            
                
                    <a href="../drawing-in-a-window/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         在窗口內繪圖
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1" data-path="drawing-in-a-window/allocating-a-graphics-context.html">
            
                
                    <a href="../drawing-in-a-window/allocating-a-graphics-context.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                         給一個圖形上下文分配內存
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2" data-path="drawing-in-a-window/changing-the-attr-of-a-graphics-context.html">
            
                
                    <a href="../drawing-in-a-window/changing-the-attr-of-a-graphics-context.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                         改變圖形上下文的屬性
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.3" data-path="drawing-in-a-window/drawing-primitives.html">
            
                
                    <a href="../drawing-in-a-window/drawing-primitives.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                         畫點東西：點、線、矩形、還有圓
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="7" data-path="x-events/README.html">
            
                
                    <a href="../x-events/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         X 事件
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1" data-path="x-events/registering-using-event-masks.html">
            
                
                    <a href="../x-events/registering-using-event-masks.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                         使用事件掩碼寄存事件類型
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.2" data-path="x-events/receiving-events.html">
            
                
                    <a href="../x-events/receiving-events.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                         接收事件：寫一個處理事件的循環
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.3" data-path="x-events/expose-events.html">
            
                
                    <a href="../x-events/expose-events.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                         暴露事件
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.4" data-path="x-events/getting-user-input.html">
            
                
                    <a href="../x-events/getting-user-input.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.</b>
                        
                         取得用戶輸入
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.4.1" data-path="x-events/mouse-press-and-release-events.html">
            
                
                    <a href="../x-events/mouse-press-and-release-events.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.1.</b>
                        
                         鼠標的按下和放開事件
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.4.2" data-path="x-events/movement-events.html">
            
                
                    <a href="../x-events/movement-events.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.2.</b>
                        
                         鼠標移動事件
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.4.3" data-path="x-events/enter-and-leave-events.html">
            
                
                    <a href="../x-events/enter-and-leave-events.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.3.</b>
                        
                         鼠標指針進入和離開區域事件
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.4.4" data-path="x-events/keyboard-focus.html">
            
                
                    <a href="../x-events/keyboard-focus.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.4.</b>
                        
                         鍵盤焦點
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.4.5" data-path="x-events/keyboard-press-and-release-events.html">
            
                
                    <a href="../x-events/keyboard-press-and-release-events.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.5.</b>
                        
                         鍵盤按鍵按下和放開事件
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="7.5" data-path="x-events/example.html">
            
                
                    <a href="../x-events/example.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.</b>
                        
                         完全示例
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8" data-path="text-and-fonts/README.html">
            
                
                    <a href="../text-and-fonts/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                         操縱文字和字體
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.1" data-path="text-and-fonts/the-font-structure.html">
            
                
                    <a href="../text-and-fonts/the-font-structure.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                         字體結構
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2" data-path="text-and-fonts/opening-a-font.html">
            
                
                    <a href="../text-and-fonts/opening-a-font.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                         打開字體
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.3" data-path="text-and-fonts/assigning-a-font-to-a-graphic-context.html">
            
                
                    <a href="../text-and-fonts/assigning-a-font-to-a-graphic-context.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                         分配一個字體到圖形上下文
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.4" data-path="text-and-fonts/drawing-text-in-a-drawable.html">
            
                
                    <a href="../text-and-fonts/drawing-text-in-a-drawable.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                         在可繪圖的區域描繪字體
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5" data-path="text-and-fonts/example.html">
            
                
                    <a href="../text-and-fonts/example.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                         完全示例
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="9" data-path="windows-hierarchy/README.html">
            
                
                    <a href="../windows-hierarchy/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                         窗口層次
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="9.1" data-path="windows-hierarchy/root-parent-and-child-windows.html">
            
                
                    <a href="../windows-hierarchy/root-parent-and-child-windows.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                         根、父和子窗口
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="9.2" data-path="windows-hierarchy/events-propagation.html">
            
                
                    <a href="../windows-hierarchy/events-propagation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                         事件傳輸
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="10" data-path="interacting-with-wm/README.html">
            
                
                    <a href="../interacting-with-wm/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                         與窗口管理器的互動
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="10.1" data-path="interacting-with-wm/window-properties.html">
            
                
                    <a href="../interacting-with-wm/window-properties.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                         窗口屬性
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="10.2" data-path="interacting-with-wm/setting-the-window-name-and-icon-name.html">
            
                
                    <a href="../interacting-with-wm/setting-the-window-name-and-icon-name.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.2.</b>
                        
                         設置窗口和圖標的名稱
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="10.3" data-path="interacting-with-wm/setting-preferred-window-sizes.html">
            
                
                    <a href="../interacting-with-wm/setting-preferred-window-sizes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.3.</b>
                        
                         設置默認的窗口大小
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="10.4" data-path="interacting-with-wm/setting-miscellaneous-wm-hints.html">
            
                
                    <a href="../interacting-with-wm/setting-miscellaneous-wm-hints.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.4.</b>
                        
                         設置各種傳給窗口管理器的提示
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="10.5" data-path="interacting-with-wm/setting-apps-icon.html">
            
                
                    <a href="../interacting-with-wm/setting-apps-icon.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.5.</b>
                        
                         設置應用的圖標
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="10.6" data-path="interacting-with-wm/obeying-the-delete-window-protocol.html">
            
                
                    <a href="../interacting-with-wm/obeying-the-delete-window-protocol.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.6.</b>
                        
                         遵守刪除窗口的協議
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="11" data-path="simple-window-operations/README.html">
            
                
                    <a href="../simple-window-operations/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                         簡易的窗口操作
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="11.1" data-path="simple-window-operations/mapping-and-unmapping.html">
            
                
                    <a href="../simple-window-operations/mapping-and-unmapping.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.</b>
                        
                         映射和反映射窗口
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.2" data-path="simple-window-operations/configuring-a-window.html">
            
                
                    <a href="../simple-window-operations/configuring-a-window.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.2.</b>
                        
                         配置窗口
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.3" data-path="simple-window-operations/moving-a-window-around-the-screen.html">
            
                
                    <a href="../simple-window-operations/moving-a-window-around-the-screen.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.3.</b>
                        
                         在屏幕中移動窗口
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.4" data-path="simple-window-operations/resizing-a-window.html">
            
                
                    <a href="../simple-window-operations/resizing-a-window.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.4.</b>
                        
                         調整窗口大小
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.5" data-path="simple-window-operations/raise-and-lower.html">
            
                
                    <a href="../simple-window-operations/raise-and-lower.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.5.</b>
                        
                         調整窗口堆疊的命令：提升和下降
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.6" data-path="simple-window-operations/iconifying-and-de-iconifying.html">
            
                
                    <a href="../simple-window-operations/iconifying-and-de-iconifying.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.6.</b>
                        
                         最小化和取消最小化
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.7" data-path="simple-window-operations/getting-info-about-a-window.html">
            
                
                    <a href="../simple-window-operations/getting-info-about-a-window.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.7.</b>
                        
                         取得窗口信息
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="12" data-path="using-colors-to-paint-the-window/README.html">
            
                
                    <a href="../using-colors-to-paint-the-window/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                         使用顏色來對窗口繪圖
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="12.1" data-path="using-colors-to-paint-the-window/color-maps.html">
            
                
                    <a href="../using-colors-to-paint-the-window/color-maps.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.1.</b>
                        
                         顏色映射
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="12.2" data-path="using-colors-to-paint-the-window/allocating-and-freeing-color-maps.html">
            
                
                    <a href="../using-colors-to-paint-the-window/allocating-and-freeing-color-maps.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.2.</b>
                        
                         分配和釋放顏色映射
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="12.3" data-path="using-colors-to-paint-the-window/allocating-and-freeing-color-entry.html">
            
                
                    <a href="../using-colors-to-paint-the-window/allocating-and-freeing-color-entry.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.3.</b>
                        
                         分配和釋放顏色記錄
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="12.4" data-path="using-colors-to-paint-the-window/drawing-with-a-color.html">
            
                
                    <a href="../using-colors-to-paint-the-window/drawing-with-a-color.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.4.</b>
                        
                         使用顏色描繪
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="13" data-path="x-bitmaps-and-x-pixmap/README.html">
            
                
                    <a href="../x-bitmaps-and-x-pixmap/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                         X 位圖和 XPM
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="13.1" data-path="x-bitmaps-and-x-pixmap/intro.html">
            
                
                    <a href="../x-bitmaps-and-x-pixmap/intro.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.1.</b>
                        
                         什麼是 X 位圖和 XPM ？
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="13.2" data-path="x-bitmaps-and-x-pixmap/loading-a-bitmap-from-a-file.html">
            
                
                    <a href="../x-bitmaps-and-x-pixmap/loading-a-bitmap-from-a-file.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.2.</b>
                        
                         從文件讀取位圖
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="13.3" data-path="x-bitmaps-and-x-pixmap/drawing-a-bitmap-in-a-window.html">
            
                
                    <a href="../x-bitmaps-and-x-pixmap/drawing-a-bitmap-in-a-window.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.3.</b>
                        
                         對窗口描繪位圖
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="13.4" data-path="x-bitmaps-and-x-pixmap/creating-a-pixmap.html">
            
                
                    <a href="../x-bitmaps-and-x-pixmap/creating-a-pixmap.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.4.</b>
                        
                         創建 XPM
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="13.5" data-path="x-bitmaps-and-x-pixmap/drawing-a-pixmap-in-a-window.html">
            
                
                    <a href="../x-bitmaps-and-x-pixmap/drawing-a-pixmap-in-a-window.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.5.</b>
                        
                         對窗口描繪 XPM
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="13.6" data-path="x-bitmaps-and-x-pixmap/freeing-a-pixmap.html">
            
                
                    <a href="../x-bitmaps-and-x-pixmap/freeing-a-pixmap.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.6.</b>
                        
                         釋放 XPM
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="14" data-path="messing-with-the-mouse-cursor/README.html">
            
                
                    <a href="../messing-with-the-mouse-cursor/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                         繪製鼠標指針
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="14.1" data-path="messing-with-the-mouse-cursor/creating-and-destroying-a-mouse-cursor.html">
            
                
                    <a href="../messing-with-the-mouse-cursor/creating-and-destroying-a-mouse-cursor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.1.</b>
                        
                         創建和銷毀鼠標指針
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="14.2" data-path="messing-with-the-mouse-cursor/setting-a-windows-mouse-cursor.html">
            
                
                    <a href="../messing-with-the-mouse-cursor/setting-a-windows-mouse-cursor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.2.</b>
                        
                         設置窗口的鼠標指針
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter active" data-level="14.3" data-path="messing-with-the-mouse-cursor/example.html">
            
                
                    <a href="../messing-with-the-mouse-cursor/example.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.3.</b>
                        
                         完全示例
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="15" data-path="traslation-of-xlib/README.html">
            
                
                    <a href="../traslation-of-xlib/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                         基礎 Xlib 函數和宏的轉譯
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" ></a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_23">
                    
                        <h1 id="">完全示例</h1>
<p>這個示例會創建一個帶按鈕的窗口。當進入窗口，鼠標指針將會變成箭頭。當按下按鈕，鼠標指針將會變成手型。當再次按下按鈕，鼠標指針會恢復為箭頭。Esc 鍵退出應用。</p>
<pre><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

#include &lt;xcb/xcb.h&gt;

#define WIDTH 300
#define HEIGHT 150




static xcb_gc_t gc_font_get (xcb_connection_t *c,
                             xcb_screen_t     *screen,
                             xcb_window_t      window,
                             const char       *font_name);

static void button_draw (xcb_connection_t *c,
                         xcb_screen_t     *screen,
                         xcb_window_t      window,
                         int16_t           x1,
                         int16_t           y1,
                         const char       *label);

static void text_draw (xcb_connection_t *c,
                       xcb_screen_t     *screen,
                       xcb_window_t      window,
                       int16_t           x1,
                       int16_t           y1,
                       const char       *label);
</code></pre><p>static void cursor_set (xcb_connection_t <em>c,
                        xcb_screen_t     </em>screen,
                        xcb_window_t      window,
                        int               cursor_id);</p>
<pre><code>static void
button_draw (xcb_connection_t *c,
             xcb_screen_t     *screen,
             xcb_window_t      window,
             int16_t           x1,
             int16_t           y1,
             const char       *label)
{
  xcb_point_t          points[5];
  xcb_void_cookie_t    cookie_gc;
  xcb_void_cookie_t    cookie_line;
  xcb_void_cookie_t    cookie_text;
  xcb_generic_error_t *error;
  xcb_gcontext_t       gc;
  int16_t              width;
  int16_t              height;
  uint8_t              length;
  int16_t              inset;

  length = strlen (label);
  inset = 2;

  gc = gc_font_get(c, screen, window, &quot;7x13&quot;);

  width = 7 * length + 2 * (inset + 1);
  height = 13 + 2 * (inset + 1);
  points[0].x = x1;
  points[0].y = y1;
  points[1].x = x1 + width;
  points[1].y = y1;
  points[2].x = x1 + width;
  points[2].y = y1 - height;
  points[3].x = x1;
  points[3].y = y1 - height;
  points[4].x = x1;
  points[4].y = y1;
  cookie_line = xcb_poly_line_checked (c, XCB_COORD_MODE_ORIGIN,
                                       window, gc, 5, points);

  error = xcb_request_check (c, cookie_line);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t draw lines : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }

  cookie_text = xcb_image_text_8_checked (c, length, window, gc,
                                          x1 + inset + 1,
                                          y1 - inset - 1, label);
  error = xcb_request_check (c, cookie_text);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t paste text : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }

  cookie_gc = xcb_free_gc (c, gc);
  error = xcb_request_check (c, cookie_gc);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t free gc : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }
}

static void
text_draw (xcb_connection_t *c,
           xcb_screen_t     *screen,
           xcb_window_t      window,
           int16_t           x1,
           int16_t           y1,
           const char       *label)
{
  xcb_void_cookie_t    cookie_gc;
  xcb_void_cookie_t    cookie_text;
  xcb_generic_error_t *error;
  xcb_gcontext_t       gc;
  uint8_t              length;

  length = strlen (label);

  gc = gc_font_get(c, screen, window, &quot;7x13&quot;);

  cookie_text = xcb_image_text_8_checked (c, length, window, gc,
                                          x1,
                                          y1, label);
  error = xcb_request_check (c, cookie_text);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t paste text : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }

  cookie_gc = xcb_free_gc (c, gc);
  error = xcb_request_check (c, cookie_gc);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t free gc : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }
}

static xcb_gc_t
gc_font_get (xcb_connection_t *c,
             xcb_screen_t     *screen,
             xcb_window_t      window,
             const char       *font_name)
{
  uint32_t             value_list[3];
  xcb_void_cookie_t    cookie_font;
  xcb_void_cookie_t    cookie_gc;
  xcb_generic_error_t *error;
  xcb_font_t           font;
  xcb_gcontext_t       gc;
  uint32_t             mask;

  font = xcb_generate_id (c);
  cookie_font = xcb_open_font_checked (c, font,
                                       strlen (font_name),
                                       font_name);

  error = xcb_request_check (c, cookie_font);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t open font : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    return -1;
  }

  gc = xcb_generate_id (c);
  mask = XCB_GC_FOREGROUND | XCB_GC_BACKGROUND | XCB_GC_FONT;
  value_list[0] = screen-&gt;black_pixel;
  value_list[1] = screen-&gt;white_pixel;
  value_list[2] = font;
  cookie_gc = xcb_create_gc_checked (c, gc, window, mask, value_list);
  error = xcb_request_check (c, cookie_gc);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t create gc : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }

  cookie_font = xcb_close_font_checked (c, font);
  error = xcb_request_check (c, cookie_font);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t close font : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }

  return gc;
}

static void
cursor_set (xcb_connection_t *c,
            xcb_screen_t     *screen,
            xcb_window_t      window,
            int               cursor_id)
{
  uint32_t             values_list[3];
  xcb_void_cookie_t    cookie_font;
  xcb_void_cookie_t    cookie_gc;
  xcb_generic_error_t *error;
  xcb_font_t           font;
  xcb_cursor_t         cursor;
  xcb_gcontext_t       gc;
  uint32_t             mask;
  uint32_t             value_list;

  font = xcb_generate_id (c);
  cookie_font = xcb_open_font_checked (c, font,
                                       strlen (&quot;cursor&quot;),
                                       &quot;cursor&quot;);
  error = xcb_request_check (c, cookie_font);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t open font : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }

  cursor = xcb_generate_id (c);
  xcb_create_glyph_cursor (c, cursor, font, font,
                           cursor_id, cursor_id + 1,
                           0, 0, 0,
                           0, 0, 0);

  gc = xcb_generate_id (c);
  mask = XCB_GC_FOREGROUND | XCB_GC_BACKGROUND | XCB_GC_FONT;
  values_list[0] = screen-&gt;black_pixel;
  values_list[1] = screen-&gt;white_pixel;
  values_list[2] = font;
  cookie_gc = xcb_create_gc_checked (c, gc, window, mask, values_list);
  error = xcb_request_check (c, cookie_gc);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t create gc : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }

  mask = XCB_CW_CURSOR;
  value_list = cursor;
  xcb_change_window_attributes (c, window, mask, &amp;amp;value_list);

  xcb_free_cursor (c, cursor);

  cookie_font = xcb_close_font_checked (c, font);
  error = xcb_request_check (c, cookie_font);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t close font : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    exit (-1);
  }
}

int main ()
{
  xcb_screen_iterator_t screen_iter;
  xcb_connection_t     *c;
  const xcb_setup_t    *setup;
  xcb_screen_t         *screen;
  xcb_generic_event_t  *e;
  xcb_generic_error_t  *error;
  xcb_void_cookie_t     cookie_window;
  xcb_void_cookie_t     cookie_map;
  xcb_window_t          window;
  uint32_t              mask;
  uint32_t              values[2];
  int                   screen_number;
  uint8_t               is_hand = 0;

  /* getting the connection */
  c = xcb_connect (NULL, &amp;amp;screen_number);
  if (!c) {
    fprintf (stderr, &quot;ERROR: can&#39;t connect to an X server\n&quot;);
    return -1;
  }

  /* getting the current screen */
  setup = xcb_get_setup (c);

  screen = NULL;
  screen_iter = xcb_setup_roots_iterator (setup);
  for (; screen_iter.rem != 0; --screen_number, xcb_screen_next (&amp;amp;screen_iter))
    if (screen_number == 0)
      {
        screen = screen_iter.data;
        break;
      }
  if (!screen) {
    fprintf (stderr, &quot;ERROR: can&#39;t get the current screen\n&quot;);
    xcb_disconnect (c);
    return -1;
  }

  /* creating the window */
  window = xcb_generate_id (c);
  mask = XCB_CW_BACK_PIXEL | XCB_CW_EVENT_MASK;
  values[0] = screen-&gt;white_pixel;
  values[1] =
    XCB_EVENT_MASK_KEY_RELEASE |
    XCB_EVENT_MASK_BUTTON_PRESS |
    XCB_EVENT_MASK_EXPOSURE |
    XCB_EVENT_MASK_POINTER_MOTION;
  cookie_window = xcb_create_window_checked (c,
                                             screen-&gt;root_depth,
                                             window, screen-&gt;root,
                                             20, 200, WIDTH, HEIGHT,
                                             0, XCB_WINDOW_CLASS_INPUT_OUTPUT,
                                             screen-&gt;root_visual,
                                             mask, values);
  cookie_map = xcb_map_window_checked (c, window);

  /* error managing */
  error = xcb_request_check (c, cookie_window);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t create window : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    return -1;
  }
  error = xcb_request_check (c, cookie_map);
  if (error) {
    fprintf (stderr, &quot;ERROR: can&#39;t map window : %d\n&quot;, error-&gt;error_code);
    xcb_disconnect (c);
    return -1;
  }

  cursor_set (c, screen, window, 68);

  xcb_flush(c);

  while (1) {
    e = xcb_poll_for_event(c);
    if (e) {
      switch (e-&gt;response_type &amp;amp; ~0x80) {
      case XCB_EXPOSE: {
        char *text;

        text = &quot;click here to change cursor&quot;;
        button_draw (c, screen, window,
                     (WIDTH - 7 * strlen(text)) / 2,
                     (HEIGHT - 16) / 2, text);

        text = &quot;Press ESC key to exit...&quot;;
        text_draw (c, screen, window, 10, HEIGHT - 10, text);
        break;
      }
      case XCB_BUTTON_PRESS: {
        xcb_button_press_event_t *ev;
        int                       length;

        ev = (xcb_button_press_event_t *)e;
        length = strlen (&quot;click here to change cursor&quot;);

        if ((ev-&gt;event_x &amp;gt;= (WIDTH - 7 * length) / 2) &amp;amp;&amp;amp;
            (ev-&gt;event_x &amp;lt;= ((WIDTH - 7 * length) / 2 + 7 * length + 6)) &amp;amp;&amp;amp;
            (ev-&gt;event_y &amp;gt;= (HEIGHT - 16) / 2 - 19) &amp;amp;&amp;amp;
            (ev-&gt;event_y &amp;lt;= ((HEIGHT - 16) / 2)))
          is_hand = 1 - is_hand;

        is_hand ? cursor_set (c, screen, window, 58) : cursor_set (c, screen, window, 68);
      }
      case XCB_KEY_RELEASE: {
        xcb_key_release_event_t *ev;

        ev = (xcb_key_release_event_t *)e;

        switch (ev-&gt;detail) {
          /* ESC */
        case 9:
          free (e);
          xcb_disconnect (c);
          return 0;
        }
      }
      }
      free (e);
    }
  }

  return 0;
}
</code></pre>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../messing-with-the-mouse-cursor/setting-a-windows-mouse-cursor.html" class="navigation navigation-prev " aria-label="Previous page: 設置窗口的鼠標指針"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../traslation-of-xlib/README.html" class="navigation navigation-next " aria-label="Next page: 基礎 Xlib 函數和宏的轉譯"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
